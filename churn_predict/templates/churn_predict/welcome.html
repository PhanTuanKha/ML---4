{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome Churn Prediction</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- (Toàn bộ CSS của bạn giữ nguyên) --- */
        :root {
            --primary-blue: #4A69FF;
            --dark-text: #1A202C;
            --light-text: #5A6372;
            --background-light: #F7FAFC;
            --white: #FFFFFF;
            --border-color: #E2E8F0;
            --footer-bg: #0F172A;
            --error-red: #e53e3e;
            --success-green: #28a745;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Be Vietnam Pro', sans-serif; line-height: 1.6; color: var(--dark-text); background-color: var(--background-light); }
        .container { max-width: 1140px; margin: 0 auto; padding: 0 20px; }
        section { padding: 40px 0; }
        h1, h2, h3, h4 { font-weight: 700; line-height: 1.3; }
        h2 { font-size: 32px; margin-bottom: 15px; }
        h3 { font-size: 24px; margin-bottom: 30px; }
        .main-header { position: fixed; top: 0; left: 0; width: 100%; background-color: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); z-index: 1000; border-bottom: 1px solid var(--border-color); }
        .main-nav { display: flex; justify-content: space-between; align-items: center; height: 80px; }
        .logo { display: flex; align-items: center; text-decoration: none; }
        .logo svg { width: 40px; height: 40px; color: var(--primary-blue); }
        .user-menu { display: flex; align-items: center; gap: 20px; }
        .user-greeting { font-weight: 600; color: var(--dark-text); }
        .btn-logout { cursor: pointer; background: none; border: 1px solid var(--error-red); color: var(--error-red); font-family: 'Be Vietnam Pro', sans-serif; text-decoration: none; padding: 8px 20px; border-radius: 8px; font-weight: 500; font-size: 15px; transition: all 0.3s ease; }
        .btn-logout:hover { background-color: var(--error-red); color: var(--white); }
        .dashboard-main { padding-top: 120px; padding-bottom: 80px; }
        .section-title { font-size: 28px; margin-bottom: 40px; color: var(--dark-text); }
        .dashboard-welcome p { font-size: 18px; color: var(--light-text); margin-bottom: 40px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; margin-bottom: 60px; }
        .stat-card { background-color: var(--white); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; display: flex; align-items: center; gap: 20px; }
        .stat-card .icon { font-size: 24px; color: var(--primary-blue); background-color: #EBF0FF; width: 50px; height: 50px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; }
        .stat-info .value { font-size: 28px; font-weight: 700; color: var(--dark-text); }
        .stat-info .label { font-size: 14px; color: var(--light-text); }
        .action-cards { display: flex; justify-content: center; gap: 40px; flex-wrap: wrap; margin-bottom: 60px; }
        .action-card { flex-basis: 400px; background-color: var(--white); border: 1px solid var(--border-color); border-radius: 12px; padding: 40px; text-align: center; text-decoration: none; color: var(--dark-text); transition: all 0.3s ease; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .action-card:hover { transform: translateY(-8px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); border-color: var(--primary-blue); }
        .action-card .card-icon { display: inline-flex; width: 70px; height: 70px; border-radius: 50%; background-color: #EBF0FF; color: var(--primary-blue); align-items: center; justify-content: center; margin-bottom: 25px; font-size: 30px; }
        .action-card h4 { font-size: 22px; margin-bottom: 10px; }
        .action-card p { font-size: 15px; color: var(--light-text); }
        .articles-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-bottom: 60px; }
        .article-card { background-color: var(--white); border: 1px solid var(--border-color); border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.05); transition: all 0.3s ease; text-decoration: none; color: var(--dark-text);}
        .article-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.07); }
        .article-card img { width: 100%; height: 180px; object-fit: cover; }
        .article-content { padding: 25px; }
        .article-category { display: inline-block; background-color: #EBF0FF; color: var(--primary-blue); padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-bottom: 15px; }
        .article-card h4 { font-size: 18px; margin-bottom: 10px; }
        .article-card p { font-size: 14px; margin-bottom: 20px; }
        .read-more-link { font-weight: 600; color: var(--primary-blue); }
        .read-more-link i { margin-left: 5px; transition: margin-left 0.2s; }
        .article-card:hover .read-more-link i { margin-left: 10px; }
        .main-footer { background-color: var(--footer-bg); color: #CBD5E1; padding: 60px 0 20px; }
        .footer-content { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 40px; margin-bottom: 40px; }
        .footer-column h4 { color: var(--white); margin-bottom: 15px; font-size: 18px; }
        .footer-column p { color: #94A3B8; }
        .footer-column ul { list-style: none; }
        .footer-column ul li { margin-bottom: 10px; }
        .footer-column ul a { text-decoration: none; color: #94A3B8; transition: color 0.3s ease; }
        .footer-column ul a:hover { color: var(--white); }
        .footer-bottom { text-align: center; padding-top: 20px; border-top: 1px solid #334155; font-size: 14px; }

        /* --- CSS CHO THÔNG BÁO VÀ UPLOAD (Gộp từ code bạn gửi) --- */
        .messages {
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
        }
        .messages li {
            padding: 15px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            border: 1px solid;
        }
        .messages li.success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        .messages li.error {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        .upload-form {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .upload-form input[type="file"] {
            flex-grow: 1;
            border: 1px solid var(--border-color);
            padding: 8px;
            border-radius: 8px;
            background: var(--white);
            font-family: 'Be Vietnam Pro', sans-serif;
            font-size: 14px;
        }
        .upload-form button {
            padding: 10px 20px;
            background: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.3s;
            font-family: 'Be Vietnam Pro', sans-serif;
            font-size: 15px;
        }
        .upload-form button:hover { opacity: 0.9; }

        @media (max-width: 768px) {
            .footer-content { grid-template-columns: 1fr; text-align: center;}
            .upload-form { flex-direction: column; align-items: stretch; }
        }
    </style>
</head>
<body>

    <header class="main-header">
        <nav class="container main-nav">
            
            <a href="{% url 'core:welcome' %}" class="logo">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>
            </a>
            <div class="user-menu">
                
                <span class="user-greeting">Hi, {{ user_name|default:'User' }}</span>
                
                <a href="{% url 'core:logout' %}" class="btn-logout">Log out</a>

            </div>
        </nav>
    </header>

    <main class="dashboard-main">
        <div class="container">
            
            {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                        <li class="{{ message.tags }}">{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            <section class="dashboard-welcome">
                
                <h2>Welcome back, {{ user_name|default:'User' }}!</h2>

                <p>Here's a quick overview of your activity and helpful resources.</p>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="icon"><i class="fas fa-users"></i></div>
                        <div class="stat-info">
                            <div class="value">1,250</div>
                            <div class="label">Customers Analyzed</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="icon"><i class="fas fa-arrow-trend-up"></i></div>
                        <div class="stat-info">
                            <div class="value">12.5%</div>
                            <div class="label">Predicted Churn Rate</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="icon"><i class="fas fa-triangle-exclamation"></i></div>
                        <div class="stat-info">
                            <div class="value">156</div>
                            <div class="label">High-Risk Customers</div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="main-actions">
                <h3 class="section-title" style="text-align: center;">Get Started</h3>
                <div class="action-cards">
                    <a href="{% url 'core:predict' %}" class="action-card">
                        <div class="card-icon"><i class="fas fa-database"></i></div>
                        <h4>Machine Learning</h4>
                        <p>Enter customer data manually to get an instant prediction result.</p>
                    </a>
                    <a href="{% url 'core:explanation' %}" class="action-card">
                        <div class="card-icon"><i class="fas fa-chart-line"></i></div>
                        <h4>Explanation</h4>
                        <p>Insights about the reason to churn, the key features driving the outcome.</p>
                    </a>
                    <a href="{% url 'core:analysis' %}" class="action-card">
                        <div class="card-icon"><i class="fas fa-chart-line"></i></div>
                        <h4>Statistics</h4>
                        <p>View and explore the structure of the sample dataset to understand the required fields.</p>
                    </a>
                </div>
            </section>

            <section class="retrain-model" style="padding-top: 0; padding-bottom: 0;">
                <h3 class="section-title">Retrain Model</h3>
                <div style="background-color: var(--white); border: 1px solid var(--border-color); border-radius: 12px; padding: 30px; margin-bottom: 60px;">
                    <h4>Upload New Dataset (.csv)</h4>
                    <p style="margin-bottom: 20px; font-size: 15px; color: var(--light-text);">
                        Upload a new CSV file to train and make predictions based on your dataset.
                    </p>
                    
                    <form action="{% url 'core:upload_retrain' %}" method="post" enctype="multipart/form-data" class="upload-form">
                        {% csrf_token %}
                        <input type="file" name="new_dataset" accept=".csv" required>
                        <button type="submit">
                            <i class="fas fa-upload"></i> Upload & Retrain
                        </button>
                    </form>

                </div>
            </section>

            <section class="knowledge-base">
                <h3 class="section-title">Articles & Knowledge Base</h3>
                <div class="articles-grid">
                    <a href="#" class="article-card">
                        <img src="https://images.unsplash.com/photo-1556742502-ec7c0e9f34b1?q=80&w=2400" alt="Article image">
                        <div class="article-content">
                            <span class="article-category">STRATEGY</span>
                            <h4>5 Effective Customer Retention Strategies for the Finance Industry</h4>
                            <p class="article-excerpt">Discover proven methods to increase loyalty and reduce churn.</p>
                            <span class="read-more-link">Read More <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </a>
                    <a href="#" class="article-card">
                        <img src="https://images.unsplash.com/photo-1516321318423-f06f85e504b3?q=80&w=2670" alt="Article image">
                        <div class="article-content">
                            <span class="article-category">ANALYTICS</span>
                            <h4>Understanding the Metrics: What Really Predicts Churn?</h4>
                            <p class="article-excerpt">Dive deep into the data to identify the most critical early warning signs from customer behavior.</p>
                            <span class="read-more-link">Read More <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </a>
                    <a href="#" class="article-card">
                        <img src="https://images.unsplash.com/photo-1665686308827-eb62e4f6604d?q=80&w=2670" alt="Article image">
                        <div class="article-content">
                            <span class="article-category">TECHNOLOGY</span>
                            <h4>The Role of AI and Machine Learning in Predicting Customer Behavior</h4>
                            <p class="article-excerpt">Learn how cutting-edge technology is changing the game in customer relationship management.</p>
                            <span class="read-more-link">Read More <i class="fas fa-arrow-right"></i></span>
                        </div>
                    </a>
                </div>
            </section>

        </div>
    </main>

    <footer class="main-footer">
        </footer>
    
</body>
</html>